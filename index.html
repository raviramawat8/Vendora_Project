<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vendora - Modern E-commerce Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .theme-transition { transition: all 0.3s ease; }
        .dark .bg-white { background-color: #1f2937; }
        .dark .text-gray-900 { color: #f9fafb; }
        .dark .text-gray-600 { color: #d1d5db; }
        .dark .bg-gray-50 { background-color: #374151; }
        .dark .bg-gray-100 { background-color: #4b5563; }
        .dark .border-gray-300 { border-color: #6b7280; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; }
        .cart-item { animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .notification { position: fixed; top: 20px; right: 20px; z-index: 1000; }
        .fade-in { animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .chart-container { height: 400px; }
    </style>
</head>
<body class="bg-gray-50 theme-transition" id="app">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg dark:bg-gray-800 theme-transition">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-4">
                    <h1 class="text-2xl font-bold text-indigo-600">Vendora</h1>
                    <div class="hidden md:flex space-x-6" id="navMenu">
                        <a href="#" class="nav-link text-gray-700 hover:text-indigo-600" onclick="showProducts()">Products</a>
                        <a href="#" class="nav-link text-gray-700 hover:text-indigo-600" onclick="showOrders()">Orders</a>
                        <a href="#" class="nav-link text-gray-700 hover:text-indigo-600" onclick="showWishlist()">Wishlist</a>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <!-- Theme Toggle -->
                    <button onclick="toggleTheme()" class="p-2 rounded-lg bg-gray-200 dark:bg-gray-700">
                        <i class="fas fa-moon dark:hidden"></i>
                        <i class="fas fa-sun hidden dark:block"></i>
                    </button>
                    
                    <!-- Cart -->
                    <button onclick="toggleCart()" class="relative p-2 text-gray-700 hover:text-indigo-600">
                        <i class="fas fa-shopping-cart text-xl"></i>
                        <span id="cartCount" class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full text-xs px-2 py-1">0</span>
                    </button>
                    
                    <!-- User Menu -->
                    <div class="relative" id="userMenu">
                        <button onclick="toggleUserDropdown()" class="flex items-center space-x-2 text-gray-700 hover:text-indigo-600">
                            <i class="fas fa-user-circle text-2xl"></i>
                            <span id="userName">Guest</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div id="userDropdown" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg z-50">
                            <div class="py-1">
                                <a href="#" onclick="showProfile()" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">Profile</a>
                                <a href="#" onclick="showAdminDashboard()" class="block px-4 py-2 text-gray-700 hover:bg-gray-100" id="adminLink" style="display:none;">Admin Dashboard</a>
                                <hr class="my-1">
                                <a href="#" onclick="logout()" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">Logout</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 py-8">
        <!-- Authentication Section -->
        <div id="authSection" class="max-w-md mx-auto bg-white rounded-lg shadow-lg p-8">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-900">Welcome to Vendora</h2>
                <p class="text-gray-600 mt-2">Your modern e-commerce experience</p>
            </div>
            
            <!-- Login Form -->
            <div id="loginForm" class="space-y-6">
                <h3 class="text-xl font-semibold text-center">Sign In</h3>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <input type="email" id="loginEmail" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Enter your email">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" id="loginPassword" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Enter your password">
                </div>
                <button onclick="login()" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition">Sign In</button>
                <div class="text-center">
                    <button onclick="showRegister()" class="text-indigo-600 hover:text-indigo-700">Don't have an account? Sign up</button>
                </div>
                <div class="text-center mt-4 p-4 bg-gray-100 rounded-lg">
                    <p class="text-sm text-gray-600 mb-2">Demo Accounts:</p>
                    <p class="text-xs"><strong>Admin:</strong> admin@vendora.com / admin123</p>
                    <p class="text-xs"><strong>Customer:</strong> user@vendora.com / user123</p>
                </div>
            </div>
            
            <!-- Register Form -->
            <div id="registerForm" class="space-y-6 hidden">
                <h3 class="text-xl font-semibold text-center">Create Account</h3>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                    <input type="text" id="registerName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Enter your name">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <input type="email" id="registerEmail" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Enter your email">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" id="registerPassword" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="Create a password">
                </div>
                <button onclick="register()" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition">Create Account</button>
                <div class="text-center">
                    <button onclick="showLogin()" class="text-indigo-600 hover:text-indigo-700">Already have an account? Sign in</button>
                </div>
            </div>
        </div>

        <!-- Customer Dashboard -->
        <div id="customerDashboard" class="hidden">
            <!-- Search and Filters -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                <div class="flex flex-wrap gap-4 items-center justify-between">
                    <div class="flex-1 min-w-64">
                        <input type="text" id="searchInput" placeholder="Search products..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                    <div class="flex gap-4">
                        <select id="categoryFilter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <option value="">All Categories</option>
                            <option value="electronics">Electronics</option>
                            <option value="clothing">Clothing</option>
                            <option value="books">Books</option>
                            <option value="home">Home & Garden</option>
                        </select>
                        <select id="sortBy" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <option value="name">Sort by Name</option>
                            <option value="price-low">Price: Low to High</option>
                            <option value="price-high">Price: High to Low</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Products Grid -->
            <div id="productsGrid" class="product-grid"></div>
        </div>

        <!-- Orders Section -->
        <div id="ordersSection" class="hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">My Orders</h2>
                <div id="ordersList"></div>
            </div>
        </div>

        <!-- Wishlist Section -->
        <div id="wishlistSection" class="hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">My Wishlist</h2>
                <div id="wishlistGrid" class="product-grid"></div>
            </div>
        </div>

        <!-- Profile Section -->
        <div id="profileSection" class="hidden">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Profile Settings</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                        <input type="text" id="profileName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                        <input type="email" id="profileEmail" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Address</label>
                        <textarea id="profileAddress" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"></textarea>
                    </div>
                    <div class="md:col-span-2">
                        <button onclick="updateProfile()" class="bg-indigo-600 text-white py-2 px-6 rounded-lg hover:bg-indigo-700 transition">Update Profile</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Dashboard -->
        <div id="adminDashboard" class="hidden">
            <!-- Admin Navigation -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                <div class="flex flex-wrap gap-4 justify-center">
                    <button onclick="showAdminAnalytics()" class="admin-nav-btn bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition">Analytics</button>
                    <button onclick="showAdminProducts()" class="admin-nav-btn bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700 transition">Manage Products</button>
                    <button onclick="showAdminOrders()" class="admin-nav-btn bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700 transition">Manage Orders</button>
                    <button onclick="showAdminUsers()" class="admin-nav-btn bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700 transition">Manage Users</button>
                </div>
            </div>

            <!-- Admin Analytics -->
            <div id="adminAnalytics" class="space-y-8">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-lg text-center">
                        <div class="text-3xl font-bold text-indigo-600" id="totalSales">$0</div>
                        <div class="text-gray-600">Total Sales</div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg text-center">
                        <div class="text-3xl font-bold text-green-600" id="totalOrders">0</div>
                        <div class="text-gray-600">Total Orders</div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg text-center">
                        <div class="text-3xl font-bold text-blue-600" id="totalProducts">0</div>
                        <div class="text-gray-600">Total Products</div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg text-center">
                        <div class="text-3xl font-bold text-purple-600" id="totalUsers">0</div>
                        <div class="text-gray-600">Total Users</div>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <h3 class="text-xl font-semibold mb-4">Sales Overview</h3>
                    <div class="chart-container">
                        <canvas id="salesChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Admin Products -->
            <div id="adminProducts" class="hidden">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">Manage Products</h2>
                        <button onclick="showAddProduct()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition">
                            <i class="fas fa-plus mr-2"></i>Add Product
                        </button>
                    </div>
                    <div id="adminProductsList"></div>
                </div>
            </div>

            <!-- Admin Orders -->
            <div id="adminOrders" class="hidden">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">Manage Orders</h2>
                    <div id="adminOrdersList"></div>
                </div>
            </div>

            <!-- Admin Users -->
            <div id="adminUsers" class="hidden">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">Manage Users</h2>
                    <div id="adminUsersList"></div>
                </div>
            </div>
        </div>
    </main>

    <!-- Shopping Cart Sidebar -->
    <div id="cartSidebar" class="fixed inset-y-0 right-0 w-96 bg-white shadow-2xl transform translate-x-full transition-transform z-50">
        <div class="p-6 h-full flex flex-col">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-bold">Shopping Cart</h2>
                <button onclick="toggleCart()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div id="cartItems" class="flex-1 overflow-y-auto space-y-4"></div>
            
            <div class="border-t pt-4 mt-4">
                <div class="flex justify-between items-center mb-4">
                    <span class="text-lg font-semibold">Total: </span>
                    <span id="cartTotal" class="text-xl font-bold text-indigo-600">$0.00</span>
                </div>
                <button onclick="checkout()" class="w-full bg-indigo-600 text-white py-3 px-4 rounded-lg hover:bg-indigo-700 transition font-semibold">
                    Proceed to Checkout
                </button>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="modalOverlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
        <!-- Product Detail Modal -->
        <div id="productModal" class="bg-white rounded-lg shadow-2xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-start mb-4">
                    <h2 id="modalProductName" class="text-2xl font-bold text-gray-900"></h2>
                    <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <img id="modalProductImage" class="w-full h-64 object-cover rounded-lg" alt="">
                    </div>
                    <div>
                        <p id="modalProductPrice" class="text-2xl font-bold text-indigo-600 mb-4"></p>
                        <p id="modalProductDescription" class="text-gray-600 mb-4"></p>
                        <p id="modalProductStock" class="text-sm text-gray-500 mb-6"></p>
                        <div class="space-y-3">
                            <button onclick="addToCartFromModal()" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition">
                                <i class="fas fa-shopping-cart mr-2"></i>Add to Cart
                            </button>
                            <button onclick="toggleWishlistFromModal()" class="w-full bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition">
                                <i class="fas fa-heart mr-2"></i>Add to Wishlist
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Checkout Modal -->
        <div id="checkoutModal" class="bg-white rounded-lg shadow-2xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto hidden">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">Checkout</h2>
                    <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="space-y-6">
                    <!-- Shipping Address -->
                    <div>
                        <h3 class="text-lg font-semibold mb-4">Shipping Address</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <input type="text" id="checkoutFirstName" placeholder="First Name" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <input type="text" id="checkoutLastName" placeholder="Last Name" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                        </div>
                        <input type="text" id="checkoutAddress" placeholder="Street Address" class="w-full mt-4 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                            <input type="text" id="checkoutCity" placeholder="City" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <input type="text" id="checkoutState" placeholder="State" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <input type="text" id="checkoutZip" placeholder="ZIP Code" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                        </div>
                    </div>

                    <!-- Payment Information -->
                    <div>
                        <h3 class="text-lg font-semibold mb-4">Payment Information</h3>
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4">
                            <p class="text-sm text-yellow-800"><i class="fas fa-info-circle mr-2"></i>This is a demo. Use test card: 4242 4242 4242 4242</p>
                        </div>
                        <input type="text" id="checkoutCardNumber" placeholder="Card Number" maxlength="19" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 mb-4">
                        <div class="grid grid-cols-2 gap-4">
                            <input type="text" id="checkoutExpiry" placeholder="MM/YY" maxlength="5" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <input type="text" id="checkoutCVV" placeholder="CVV" maxlength="3" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                        </div>
                    </div>

                    <!-- Order Summary -->
                    <div>
                        <h3 class="text-lg font-semibold mb-4">Order Summary</h3>
                        <div id="checkoutSummary" class="bg-gray-50 p-4 rounded-lg"></div>
                    </div>

                    <button onclick="processPayment()" class="w-full bg-indigo-600 text-white py-3 px-4 rounded-lg hover:bg-indigo-700 transition font-semibold">
                        <i class="fas fa-credit-card mr-2"></i>Place Order
                    </button>
                </div>
            </div>
        </div>

        <!-- Add/Edit Product Modal -->
        <div id="productFormModal" class="bg-white rounded-lg shadow-2xl max-w-lg w-full mx-4 max-h-screen overflow-y-auto hidden">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 id="productFormTitle" class="text-xl font-bold text-gray-900">Add Product</h2>
                    <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <form id="productForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Product Name</label>
                        <input type="text" id="formProductName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                        <textarea id="formProductDescription" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" required></textarea>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Price</label>
                            <input type="number" id="formProductPrice" step="0.01" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Stock</label>
                            <input type="number" id="formProductStock" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" required>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Category</label>
                        <select id="formProductCategory" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" required>
                            <option value="">Select Category</option>
                            <option value="electronics">Electronics</option>
                            <option value="clothing">Clothing</option>
                            <option value="books">Books</option>
                            <option value="home">Home & Garden</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Image URL</label>
                        <input type="url" id="formProductImage" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                    <div class="flex gap-4">
                        <button type="button" onclick="saveProduct()" class="flex-1 bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition">Save Product</button>
                        <button type="button" onclick="closeModal()" class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Notifications -->
    <div id="notifications" class="notification"></div>

    <script>
        // Application State
        let currentUser = null;
        let products = [];
        let cart = [];
        let wishlist = [];
        let orders = [];
        let users = [];
        let currentProduct = null;
        let editingProduct = null;

        // Initialize Application
        function initApp() {
            loadData();
            setupEventListeners();
            checkAuth();
            loadSampleData();
        }

        // Data Management
        function loadData() {
            products = JSON.parse(localStorage.getItem('vendora_products') || '[]');
            cart = JSON.parse(localStorage.getItem('vendora_cart') || '[]');
            wishlist = JSON.parse(localStorage.getItem('vendora_wishlist') || '[]');
            orders = JSON.parse(localStorage.getItem('vendora_orders') || '[]');
            users = JSON.parse(localStorage.getItem('vendora_users') || '[]');
        }

        function saveData() {
            localStorage.setItem('vendora_products', JSON.stringify(products));
            localStorage.setItem('vendora_cart', JSON.stringify(cart));
            localStorage.setItem('vendora_wishlist', JSON.stringify(wishlist));
            localStorage.setItem('vendora_orders', JSON.stringify(orders));
            localStorage.setItem('vendora_users', JSON.stringify(users));
        }

        function loadSampleData() {
            if (products.length === 0) {
                products = [
                    {
                        id: 1,
                        name: 'Wireless Bluetooth Headphones',
                        description: 'High-quality wireless headphones with noise cancellation and 30-hour battery life.',
                        price: 199.99,
                        category: 'electronics',
                        stock: 50,
                        image: 'https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=400'
                    },
                    {
                        id: 2,
                        name: 'Organic Cotton T-Shirt',
                        description: 'Comfortable and sustainable organic cotton t-shirt available in multiple colors.',
                        price: 29.99,
                        category: 'clothing',
                        stock: 100,
                        image: 'https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=400'
                    },
                    {
                        id: 3,
                        name: 'JavaScript: The Complete Guide',
                        description: 'Comprehensive guide to modern JavaScript programming with practical examples.',
                        price: 49.99,
                        category: 'books',
                        stock: 25,
                        image: 'https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?w=400'
                    },
                    {
                        id: 4,
                        name: 'Smart LED Plant Light',
                        description: 'Full spectrum LED grow light perfect for indoor plants and herbs.',
                        price: 79.99,
                        category: 'home',
                        stock: 30,
                        image: 'https://images.unsplash.com/photo-1416879595882-3373a0480b5b?w=400'
                    },
                    {
                        id: 5,
                        name: 'Wireless Charging Pad',
                        description: 'Fast wireless charging pad compatible with all Qi-enabled devices.',
                        price: 39.99,
                        category: 'electronics',
                        stock: 75,
                        image: 'https://images.unsplash.com/photo-1609592657203-75c56bb965dc?w=400'
                    },
                    {
                        id: 6,
                        name: 'Yoga Mat Premium',
                        description: 'High-quality yoga mat with superior grip and cushioning for all yoga practices.',
                        price: 69.99,
                        category: 'home',
                        stock: 40,
                        image: 'https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?w=400'
                    }
                ];
                
                users = [
                    {
                        id: 1,
                        name: 'Admin User',
                        email: 'admin@vendora.com',
                        password: 'admin123',
                        role: 'admin',
                        address: '123 Admin St, Admin City, AC 12345'
                    },
                    {
                        id: 2,
                        name: 'John Customer',
                        email: 'user@vendora.com',
                        password: 'user123',
                        role: 'customer',
                        address: '456 Customer Ave, Customer City, CC 67890'
                    }
                ];
                
                saveData();
            }
        }

        // Event Listeners
        function setupEventListeners() {
            document.getElementById('searchInput').addEventListener('input', filterProducts);
            document.getElementById('categoryFilter').addEventListener('change', filterProducts);
            document.getElementById('sortBy').addEventListener('change', filterProducts);
            
            // Card number formatting
            document.getElementById('checkoutCardNumber').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\s/g, '');
                let formattedValue = value.replace(/(.{4})/g, '$1 ').trim();
                if (formattedValue.length > 19) formattedValue = formattedValue.substr(0, 19);
                e.target.value = formattedValue;
            });
            
            // Expiry date formatting
            document.getElementById('checkoutExpiry').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length >= 2) {
                    value = value.substring(0, 2) + '/' + value.substring(2, 4);
                }
                e.target.value = value;
            });
        }

        // Authentication
        function checkAuth() {
            const savedUser = localStorage.getItem('vendora_currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showDashboard();
            } else {
                showAuth();
            }
        }

        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                currentUser = user;
                localStorage.setItem('vendora_currentUser', JSON.stringify(user));
                showNotification('Login successful!', 'success');
                showDashboard();
            } else {
                showNotification('Invalid email or password', 'error');
            }
        }

        function register() {
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            
            if (users.find(u => u.email === email)) {
                showNotification('Email already exists', 'error');
                return;
            }
            
            const newUser = {
                id: Date.now(),
                name,
                email,
                password,
                role: 'customer',
                address: ''
            };
            
            users.push(newUser);
            saveData();
            
            currentUser = newUser;
            localStorage.setItem('vendora_currentUser', JSON.stringify(newUser));
            showNotification('Account created successfully!', 'success');
            showDashboard();
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('vendora_currentUser');
            cart = [];
            wishlist = [];
            updateCartUI();
            showAuth();
            showNotification('Logged out successfully', 'success');
        }

        // UI Navigation
        function showAuth() {
            document.getElementById('authSection').classList.remove('hidden');
            document.getElementById('customerDashboard').classList.add('hidden');
            document.getElementById('adminDashboard').classList.add('hidden');
            hideAllSections();
        }

        function showDashboard() {
            document.getElementById('authSection').classList.add('hidden');
            document.getElementById('userName').textContent = currentUser.name;
            
            if (currentUser.role === 'admin') {
                document.getElementById('adminLink').style.display = 'block';
            }
            
            loadUserData();
            showProducts();
        }

        function hideAllSections() {
            document.getElementById('ordersSection').classList.add('hidden');
            document.getElementById('wishlistSection').classList.add('hidden');
            document.getElementById('profileSection').classList.add('hidden');
        }

        function showProducts() {
            hideAllSections();
            document.getElementById('customerDashboard').classList.remove('hidden');
            document.getElementById('adminDashboard').classList.add('hidden');
            renderProducts();
        }

        function showOrders() {
            hideAllSections();
            document.getElementById('ordersSection').classList.remove('hidden');
            document.getElementById('customerDashboard').classList.add('hidden');
            document.getElementById('adminDashboard').classList.add('hidden');
            renderOrders();
        }

        function showWishlist() {
            hideAllSections();
            document.getElementById('wishlistSection').classList.remove('hidden');
            document.getElementById('customerDashboard').classList.add('hidden');
            document.getElementById('adminDashboard').classList.add('hidden');
            renderWishlist();
        }

        function showProfile() {
            hideAllSections();
            document.getElementById('profileSection').classList.remove('hidden');
            document.getElementById('customerDashboard').classList.add('hidden');
            document.getElementById('adminDashboard').classList.add('hidden');
            loadProfile();
        }

        function showLogin() {
            document.getElementById('loginForm').classList.remove('hidden');
            document.getElementById('registerForm').classList.add('hidden');
        }

        function showRegister() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('registerForm').classList.remove('hidden');
        }

        // Product Management
        function renderProducts() {
            const grid = document.getElementById('productsGrid');
            const filteredProducts = getFilteredProducts();
            
            grid.innerHTML = filteredProducts.map(product => `
                <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow">
                    <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover cursor-pointer" onclick="showProductDetail(${product.id})">
                    <div class="p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-2">${product.name}</h3>
                        <p class="text-gray-600 text-sm mb-4 line-clamp-2">${product.description}</p>
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-2xl font-bold text-indigo-600">$${product.price.toFixed(2)}</span>
                            <span class="text-sm text-gray-500">${product.stock} in stock</span>
                        </div>
                        <div class="space-y-2">
                            <button onclick="addToCart(${product.id})" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition ${product.stock === 0 ? 'opacity-50 cursor-not-allowed' : ''}" ${product.stock === 0 ? 'disabled' : ''}>
                                <i class="fas fa-shopping-cart mr-2"></i>Add to Cart
                            </button>
                            <button onclick="toggleWishlist(${product.id})" class="w-full bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition">
                                <i class="fas fa-heart mr-2 ${wishlist.includes(product.id) ? 'text-red-500' : ''}"></i>
                                ${wishlist.includes(product.id) ? 'Remove from Wishlist' : 'Add to Wishlist'}
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function getFilteredProducts() {
            let filtered = [...products];
            
            const search = document.getElementById('searchInput').value.toLowerCase();
            const category = document.getElementById('categoryFilter').value;
            const sortBy = document.getElementById('sortBy').value;
            
            if (search) {
                filtered = filtered.filter(product => 
                    product.name.toLowerCase().includes(search) ||
                    product.description.toLowerCase().includes(search)
                );
            }
            
            if (category) {
                filtered = filtered.filter(product => product.category === category);
            }
            
            switch (sortBy) {
                case 'price-low':
                    filtered.sort((a, b) => a.price - b.price);
                    break;
                case 'price-high':
                    filtered.sort((a, b) => b.price - a.price);
                    break;
                default:
                    filtered.sort((a, b) => a.name.localeCompare(b.name));
            }
            
            return filtered;
        }

        function filterProducts() {
            renderProducts();
        }

        function showProductDetail(productId) {
            const product = products.find(p => p.id === productId);
            currentProduct = product;
            
            document.getElementById('modalProductName').textContent = product.name;
            document.getElementById('modalProductImage').src = product.image;
            document.getElementById('modalProductPrice').textContent = `$${product.price.toFixed(2)}`;
            document.getElementById('modalProductDescription').textContent = product.description;
            document.getElementById('modalProductStock').textContent = `${product.stock} in stock`;
            
            document.getElementById('productModal').classList.remove('hidden');
            document.getElementById('checkoutModal').classList.add('hidden');
            document.getElementById('productFormModal').classList.add('hidden');
            document.getElementById('modalOverlay').classList.remove('hidden');
        }

        // Shopping Cart
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (!product || product.stock === 0) return;
            
            const existingItem = cart.find(item => item.productId === productId);
            if (existingItem) {
                if (existingItem.quantity < product.stock) {
                    existingItem.quantity++;
                }
            } else {
                cart.push({ productId, quantity: 1 });
            }
            
            updateCartUI();
            saveData();
            showNotification('Product added to cart!', 'success');
        }

        function addToCartFromModal() {
            if (currentProduct) {
                addToCart(currentProduct.id);
                closeModal();
            }
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.productId !== productId);
            updateCartUI();
            saveData();
        }

        function updateQuantity(productId, change) {
            const item = cart.find(item => item.productId === productId);
            const product = products.find(p => p.id === productId);
            
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(productId);
                } else if (item.quantity > product.stock) {
                    item.quantity = product.stock;
                }
                updateCartUI();
                saveData();
            }
        }

        function updateCartUI() {
            const cartCount = document.getElementById('cartCount');
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCount.textContent = totalItems;
            
            let total = 0;
            cartItems.innerHTML = cart.map(item => {
                const product = products.find(p => p.id === item.productId);
                const subtotal = product.price * item.quantity;
                total += subtotal;
                
                return `
                    <div class="cart-item flex items-center space-x-4 p-4 border border-gray-200 rounded-lg">
                        <img src="${product.image}" alt="${product.name}" class="w-16 h-16 object-cover rounded">
                        <div class="flex-1">
                            <h4 class="font-semibold text-sm">${product.name}</h4>
                            <p class="text-gray-600 text-xs">$${product.price.toFixed(2)} each</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button onclick="updateQuantity(${item.productId}, -1)" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center hover:bg-gray-300">
                                <i class="fas fa-minus text-xs"></i>
                            </button>
                            <span class="w-8 text-center">${item.quantity}</span>
                            <button onclick="updateQuantity(${item.productId}, 1)" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center hover:bg-gray-300">
                                <i class="fas fa-plus text-xs"></i>
                            </button>
                        </div>
                        <button onclick="removeFromCart(${item.productId})" class="text-red-500 hover:text-red-700">
                            <i class="fas fa-trash text-sm"></i>
                        </button>
                    </div>
                `;
            }).join('');
            
            cartTotal.textContent = `$${total.toFixed(2)}`;
        }

        function toggleCart() {
            const sidebar = document.getElementById('cartSidebar');
            sidebar.classList.toggle('translate-x-full');
        }

        // Wishlist
        function toggleWishlist(productId) {
            const index = wishlist.indexOf(productId);
            if (index > -1) {
                wishlist.splice(index, 1);
                showNotification('Removed from wishlist', 'success');
            } else {
                wishlist.push(productId);
                showNotification('Added to wishlist!', 'success');
            }
            
            saveData();
            renderProducts();
            if (document.getElementById('wishlistSection').classList.contains('hidden') === false) {
                renderWishlist();
            }
        }

        function toggleWishlistFromModal() {
            if (currentProduct) {
                toggleWishlist(currentProduct.id);
                closeModal();
            }
        }

        function renderWishlist() {
            const grid = document.getElementById('wishlistGrid');
            const wishlistProducts = products.filter(p => wishlist.includes(p.id));
            
            grid.innerHTML = wishlistProducts.map(product => `
                <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow">
                    <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover cursor-pointer" onclick="showProductDetail(${product.id})">
                    <div class="p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-2">${product.name}</h3>
                        <p class="text-gray-600 text-sm mb-4">${product.description}</p>
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-2xl font-bold text-indigo-600">$${product.price.toFixed(2)}</span>
                            <span class="text-sm text-gray-500">${product.stock} in stock</span>
                        </div>
                        <div class="space-y-2">
                            <button onclick="addToCart(${product.id})" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition">
                                <i class="fas fa-shopping-cart mr-2"></i>Add to Cart
                            </button>
                            <button onclick="toggleWishlist(${product.id})" class="w-full bg-red-500 text-white py-2 px-4 rounded-lg hover:bg-red-600 transition">
                                <i class="fas fa-heart mr-2"></i>Remove from Wishlist
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Checkout
        function checkout() {
            if (cart.length === 0) {
                showNotification('Cart is empty', 'error');
                return;
            }
            
            const checkoutSummary = document.getElementById('checkoutSummary');
            let total = 0;
            
            const summaryHTML = cart.map(item => {
                const product = products.find(p => p.id === item.productId);
                const subtotal = product.price * item.quantity;
                total += subtotal;
                
                return `
                    <div class="flex justify-between items-center py-2">
                        <span>${product.name}  ${item.quantity}</span>
                        <span>$${subtotal.toFixed(2)}</span>
                    </div>
                `;
            }).join('');
            
            checkoutSummary.innerHTML = `
                ${summaryHTML}
                <hr class="my-2">
                <div class="flex justify-between items-center py-2 font-semibold text-lg">
                    <span>Total</span>
                    <span>$${total.toFixed(2)}</span>
                </div>
            `;
            
            // Pre-fill user information if available
            if (currentUser) {
                document.getElementById('checkoutFirstName').value = currentUser.name.split(' ')[0] || '';
                document.getElementById('checkoutLastName').value = currentUser.name.split(' ').slice(1).join(' ') || '';
            }
            
            document.getElementById('productModal').classList.add('hidden');
            document.getElementById('checkoutModal').classList.remove('hidden');
            document.getElementById('productFormModal').classList.add('hidden');
            document.getElementById('modalOverlay').classList.remove('hidden');
        }

        function processPayment() {
            // Simulate payment processing
            const cardNumber = document.getElementById('checkoutCardNumber').value.replace(/\s/g, '');
            if (cardNumber !== '4242424242424242') {
                showNotification('Invalid card number. Use 4242 4242 4242 4242 for demo.', 'error');
                return;
            }
            
            // Create order
            const order = {
                id: Date.now(),
                userId: currentUser.id,
                items: [...cart],
                total: cart.reduce((sum, item) => {
                    const product = products.find(p => p.id === item.productId);
                    return sum + (product.price * item.quantity);
                }, 0),
                status: 'pending',
                date: new Date().toISOString(),
                shippingAddress: {
                    firstName: document.getElementById('checkoutFirstName').value,
                    lastName: document.getElementById('checkoutLastName').value,
                    address: document.getElementById('checkoutAddress').value,
                    city: document.getElementById('checkoutCity').value,
                    state: document.getElementById('checkoutState').value,
                    zip: document.getElementById('checkoutZip').value
                }
            };
            
            // Update product stock
            cart.forEach(item => {
                const product = products.find(p => p.id === item.productId);
                if (product) {
                    product.stock -= item.quantity;
                }
            });
            
            orders.push(order);
            cart = [];
            
            saveData();
            updateCartUI();
            closeModal();
            toggleCart();
            
            showNotification('Order placed successfully! Order ID: ' + order.id, 'success');
            
            // Show order confirmation
            setTimeout(() => {
                showOrders();
            }, 1000);
        }

        // Orders Management
        function renderOrders() {
            const ordersList = document.getElementById('ordersList');
            const userOrders = orders.filter(order => order.userId === currentUser.id);
            
            if (userOrders.length === 0) {
                ordersList.innerHTML = '<p class="text-gray-600 text-center py-8">No orders found.</p>';
                return;
            }
            
            ordersList.innerHTML = userOrders.map(order => `
                <div class="border border-gray-200 rounded-lg p-6 mb-4">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="font-semibold text-lg">Order #${order.id}</h3>
                            <p class="text-gray-600">${new Date(order.date).toLocaleDateString()}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-2xl font-bold text-indigo-600">$${order.total.toFixed(2)}</p>
                            <span class="inline-block px-3 py-1 rounded-full text-sm font-medium ${getStatusColor(order.status)}">${order.status.charAt(0).toUpperCase() + order.status.slice(1)}</span>
                        </div>
                    </div>
                    <div class="space-y-2">
                        ${order.items.map(item => {
                            const product = products.find(p => p.id === item.productId);
                            return `
                                <div class="flex justify-between items-center py-2 border-b border-gray-100">
                                    <span>${product?.name || 'Product not found'}  ${item.quantity}</span>
                                    <span>$${((product?.price || 0) * item.quantity).toFixed(2)}</span>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    ${order.shippingAddress ? `
                        <div class="mt-4 pt-4 border-t border-gray-200">
                            <h4 class="font-medium mb-2">Shipping Address:</h4>
                            <p class="text-gray-600 text-sm">
                                ${order.shippingAddress.firstName} ${order.shippingAddress.lastName}<br>
                                ${order.shippingAddress.address}<br>
                                ${order.shippingAddress.city}, ${order.shippingAddress.state} ${order.shippingAddress.zip}
                            </p>
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function getStatusColor(status) {
            switch (status) {
                case 'pending': return 'bg-yellow-100 text-yellow-800';
                case 'shipped': return 'bg-blue-100 text-blue-800';
                case 'delivered': return 'bg-green-100 text-green-800';
                case 'cancelled': return 'bg-red-100 text-red-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        // Profile Management
        function loadProfile() {
            if (currentUser) {
                document.getElementById('profileName').value = currentUser.name;
                document.getElementById('profileEmail').value = currentUser.email;
                document.getElementById('profileAddress').value = currentUser.address || '';
            }
        }

        function updateProfile() {
            if (currentUser) {
                currentUser.name = document.getElementById('profileName').value;
                currentUser.email = document.getElementById('profileEmail').value;
                currentUser.address = document.getElementById('profileAddress').value;
                
                // Update user in users array
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex > -1) {
                    users[userIndex] = currentUser;
                }
                
                localStorage.setItem('vendora_currentUser', JSON.stringify(currentUser));
                document.getElementById('userName').textContent = currentUser.name;
                saveData();
                showNotification('Profile updated successfully!', 'success');
            }
        }

        // Admin Dashboard
        function showAdminDashboard() {
            if (currentUser.role !== 'admin') {
                showNotification('Access denied. Admin privileges required.', 'error');
                return;
            }
            
            hideAllSections();
            document.getElementById('customerDashboard').classList.add('hidden');
            document.getElementById('adminDashboard').classList.remove('hidden');
            showAdminAnalytics();
        }

        function showAdminAnalytics() {
            updateAdminNavigation('showAdminAnalytics');
            document.getElementById('adminAnalytics').classList.remove('hidden');
            document.getElementById('adminProducts').classList.add('hidden');
            document.getElementById('adminOrders').classList.add('hidden');
            document.getElementById('adminUsers').classList.add('hidden');
            
            updateAnalytics();
            renderSalesChart();
        }

        function showAdminProducts() {
            updateAdminNavigation('showAdminProducts');
            document.getElementById('adminAnalytics').classList.add('hidden');
            document.getElementById('adminProducts').classList.remove('hidden');
            document.getElementById('adminOrders').classList.add('hidden');
            document.getElementById('adminUsers').classList.add('hidden');
            
            renderAdminProducts();
        }

        function showAdminOrders() {
            updateAdminNavigation('showAdminOrders');
            document.getElementById('adminAnalytics').classList.add('hidden');
            document.getElementById('adminProducts').classList.add('hidden');
            document.getElementById('adminOrders').classList.remove('hidden');
            document.getElementById('adminUsers').classList.add('hidden');
            
            renderAdminOrders();
        }

        function showAdminUsers() {
            updateAdminNavigation('showAdminUsers');
            document.getElementById('adminAnalytics').classList.add('hidden');
            document.getElementById('adminProducts').classList.add('hidden');
            document.getElementById('adminOrders').classList.add('hidden');
            document.getElementById('adminUsers').classList.remove('hidden');
            
            renderAdminUsers();
        }

        function updateAdminNavigation(activeFunction) {
            document.querySelectorAll('.admin-nav-btn').forEach(btn => {
                if (btn.onclick.toString().includes(activeFunction)) {
                    btn.classList.remove('bg-gray-600', 'hover:bg-gray-700');
                    btn.classList.add('bg-indigo-600', 'hover:bg-indigo-700');
                } else {
                    btn.classList.remove('bg-indigo-600', 'hover:bg-indigo-700');
                    btn.classList.add('bg-gray-600', 'hover:bg-gray-700');
                }
            });
        }

        function updateAnalytics() {
            const totalSales = orders.reduce((sum, order) => sum + order.total, 0);
            const totalOrders = orders.length;
            const totalProducts = products.length;
            const totalUsers = users.filter(u => u.role === 'customer').length;
            
            document.getElementById('totalSales').textContent = `$${totalSales.toFixed(2)}`;
            document.getElementById('totalOrders').textContent = totalOrders;
            document.getElementById('totalProducts').textContent = totalProducts;
            document.getElementById('totalUsers').textContent = totalUsers;
        }

        function renderSalesChart() {
            const ctx = document.getElementById('salesChart').getContext('2d');
            
            // Generate sample monthly data
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];
            const salesData = [1200, 1900, 3000, 2500, 2200, 3200];
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [{
                        label: 'Monthly Sales',
                        data: salesData,
                        borderColor: 'rgb(79, 70, 229)',
                        backgroundColor: 'rgba(79, 70, 229, 0.1)',
                        tension: 0.1,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Sales Performance'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value;
                                }
                            }
                        }
                    }
                }
            });
        }

        function renderAdminProducts() {
            const productsList = document.getElementById('adminProductsList');
            
            productsList.innerHTML = `
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border border-gray-300">
                        <thead>
                            <tr class="bg-gray-50">
                                <th class="border border-gray-300 px-4 py-2 text-left">Name</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Category</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Price</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Stock</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${products.map(product => `
                                <tr>
                                    <td class="border border-gray-300 px-4 py-2">${product.name}</td>
                                    <td class="border border-gray-300 px-4 py-2">${product.category}</td>
                                    <td class="border border-gray-300 px-4 py-2">$${product.price.toFixed(2)}</td>
                                    <td class="border border-gray-300 px-4 py-2">${product.stock}</td>
                                    <td class="border border-gray-300 px-4 py-2">
                                        <button onclick="editProduct(${product.id})" class="bg-blue-500 text-white px-3 py-1 rounded mr-2 hover:bg-blue-600">Edit</button>
                                        <button onclick="deleteProduct(${product.id})" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600">Delete</button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        function renderAdminOrders() {
            const ordersList = document.getElementById('adminOrdersList');
            
            ordersList.innerHTML = `
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border border-gray-300">
                        <thead>
                            <tr class="bg-gray-50">
                                <th class="border border-gray-300 px-4 py-2 text-left">Order ID</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Customer</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Date</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Total</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Status</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${orders.map(order => {
                                const user = users.find(u => u.id === order.userId);
                                return `
                                    <tr>
                                        <td class="border border-gray-300 px-4 py-2">#${order.id}</td>
                                        <td class="border border-gray-300 px-4 py-2">${user?.name || 'Unknown'}</td>
                                        <td class="border border-gray-300 px-4 py-2">${new Date(order.date).toLocaleDateString()}</td>
                                        <td class="border border-gray-300 px-4 py-2">$${order.total.toFixed(2)}</td>
                                        <td class="border border-gray-300 px-4 py-2">
                                            <select onchange="updateOrderStatus(${order.id}, this.value)" class="px-2 py-1 border border-gray-300 rounded">
                                                <option value="pending" ${order.status === 'pending' ? 'selected' : ''}>Pending</option>
                                                <option value="shipped" ${order.status === 'shipped' ? 'selected' : ''}>Shipped</option>
                                                <option value="delivered" ${order.status === 'delivered' ? 'selected' : ''}>Delivered</option>
                                                <option value="cancelled" ${order.status === 'cancelled' ? 'selected' : ''}>Cancelled</option>
                                            </select>
                                        </td>
                                        <td class="border border-gray-300 px-4 py-2">
                                            <button onclick="viewOrderDetails(${order.id})" class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600">View</button>
                                        </td>
                                    </tr>
                                `;
                            }).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        function renderAdminUsers() {
            const usersList = document.getElementById('adminUsersList');
            
            usersList.innerHTML = `
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border border-gray-300">
                        <thead>
                            <tr class="bg-gray-50">
                                <th class="border border-gray-300 px-4 py-2 text-left">Name</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Email</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Role</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Orders</th>
                                <th class="border border-gray-300 px-4 py-2 text-left">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${users.filter(user => user.role === 'customer').map(user => {
                                const userOrders = orders.filter(order => order.userId === user.id);
                                return `
                                    <tr>
                                        <td class="border border-gray-300 px-4 py-2">${user.name}</td>
                                        <td class="border border-gray-300 px-4 py-2">${user.email}</td>
                                        <td class="border border-gray-300 px-4 py-2">${user.role}</td>
                                        <td class="border border-gray-300 px-4 py-2">${userOrders.length}</td>
                                        <td class="border border-gray-300 px-4 py-2">
                                            <button onclick="viewUserDetails(${user.id})" class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600">View</button>
                                        </td>
                                    </tr>
                                `;
                            }).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        // Product CRUD Operations
        function showAddProduct() {
            editingProduct = null;
            document.getElementById('productFormTitle').textContent = 'Add Product';
            document.getElementById('productForm').reset();
            
            document.getElementById('productModal').classList.add('hidden');
            document.getElementById('checkoutModal').classList.add('hidden');
            document.getElementById('productFormModal').classList.remove('hidden');
            document.getElementById('modalOverlay').classList.remove('hidden');
        }

        function editProduct(productId) {
            const product = products.find(p => p.id === productId);
            editingProduct = product;
            
            document.getElementById('productFormTitle').textContent = 'Edit Product';
            document.getElementById('formProductName').value = product.name;
            document.getElementById('formProductDescription').value = product.description;
            document.getElementById('formProductPrice').value = product.price;
            document.getElementById('formProductStock').value = product.stock;
            document.getElementById('formProductCategory').value = product.category;
            document.getElementById('formProductImage').value = product.image || '';
            
            document.getElementById('productModal').classList.add('hidden');
            document.getElementById('checkoutModal').classList.add('hidden');
            document.getElementById('productFormModal').classList.remove('hidden');
            document.getElementById('modalOverlay').classList.remove('hidden');
        }

        function saveProduct() {
            const name = document.getElementById('formProductName').value;
            const description = document.getElementById('formProductDescription').value;
            const price = parseFloat(document.getElementById('formProductPrice').value);
            const stock = parseInt(document.getElementById('formProductStock').value);
            const category = document.getElementById('formProductCategory').value;
            const image = document.getElementById('formProductImage').value || 'https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=400';
            
            if (!name || !description || !price || !stock || !category) {
                showNotification('Please fill all required fields', 'error');
                return;
            }
            
            if (editingProduct) {
                // Update existing product
                editingProduct.name = name;
                editingProduct.description = description;
                editingProduct.price = price;
                editingProduct.stock = stock;
                editingProduct.category = category;
                editingProduct.image = image;
                showNotification('Product updated successfully!', 'success');
            } else {
                // Add new product
                const newProduct = {
                    id: Date.now(),
                    name,
                    description,
                    price,
                    stock,
                    category,
                    image
                };
                products.push(newProduct);
                showNotification('Product added successfully!', 'success');
            }
            
            saveData();
            closeModal();
            renderAdminProducts();
        }

        function deleteProduct(productId) {
            if (confirm('Are you sure you want to delete this product?')) {
                products = products.filter(p => p.id !== productId);
                saveData();
                showNotification('Product deleted successfully!', 'success');
                renderAdminProducts();
            }
        }

        function updateOrderStatus(orderId, newStatus) {
            const order = orders.find(o => o.id === orderId);
            if (order) {
                order.status = newStatus;
                saveData();
                showNotification('Order status updated!', 'success');
            }
        }

        function viewOrderDetails(orderId) {
            const order = orders.find(o => o.id === orderId);
            const user = users.find(u => u.id === order.userId);
            
            const details = `
                Order ID: ${order.id}
                Customer: ${user?.name || 'Unknown'}
                Date: ${new Date(order.date).toLocaleDateString()}
                Total: $${order.total.toFixed(2)}
                Status: ${order.status}
                
                Items:
                ${order.items.map(item => {
                    const product = products.find(p => p.id === item.productId);
                    return `- ${product?.name || 'Unknown'} x ${item.quantity}`;
                }).join('\n')}
                
                Shipping Address:
                ${order.shippingAddress?.firstName} ${order.shippingAddress?.lastName}
                ${order.shippingAddress?.address}
                ${order.shippingAddress?.city}, ${order.shippingAddress?.state} ${order.shippingAddress?.zip}
            `;
            
            alert(details);
        }

        function viewUserDetails(userId) {
            const user = users.find(u => u.id === userId);
            const userOrders = orders.filter(order => order.userId === userId);
            const totalSpent = userOrders.reduce((sum, order) => sum + order.total, 0);
            
            const details = `
                Name: ${user.name}
                Email: ${user.email}
                Role: ${user.role}
                Address: ${user.address || 'Not provided'}
                
                Order Statistics:
                Total Orders: ${userOrders.length}
                Total Spent: $${totalSpent.toFixed(2)}
            `;
            
            alert(details);
        }

        // Utility Functions
        function loadUserData() {
            const userCart = localStorage.getItem(`vendora_cart_${currentUser.id}`);
            const userWishlist = localStorage.getItem(`vendora_wishlist_${currentUser.id}`);
            
            if (userCart) cart = JSON.parse(userCart);
            if (userWishlist) wishlist = JSON.parse(userWishlist);
            
            updateCartUI();
        }

        function toggleUserDropdown() {
            document.getElementById('userDropdown').classList.toggle('hidden');
        }

        function toggleTheme() {
            document.documentElement.classList.toggle('dark');
            const isDark = document.documentElement.classList.contains('dark');
            localStorage.setItem('vendora_theme', isDark ? 'dark' : 'light');
        }

        function closeModal() {
            document.getElementById('modalOverlay').classList.add('hidden');
            document.getElementById('productModal').classList.add('hidden');
            document.getElementById('checkoutModal').classList.add('hidden');
            document.getElementById('productFormModal').classList.add('hidden');
        }

        function showNotification(message, type = 'info') {
            const notifications = document.getElementById('notifications');
            const notification = document.createElement('div');
            
            const bgColor = type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500';
            
            notification.className = `${bgColor} text-white px-6 py-3 rounded-lg shadow-lg mb-4 fade-in`;
            notification.innerHTML = `
                <div class="flex items-center justify-between">
                    <span>${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-4 text-white hover:text-gray-200">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            notifications.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            const userMenu = document.getElementById('userMenu');
            if (!userMenu.contains(event.target)) {
                document.getElementById('userDropdown').classList.add('hidden');
            }
            
            const modal = document.getElementById('modalOverlay');
            if (modal.classList.contains('hidden') === false && event.target === modal) {
                closeModal();
            }
        });

        // Load theme preference
        const savedTheme = localStorage.getItem('vendora_theme');
        if (savedTheme === 'dark') {
            document.documentElement.classList.add('dark');
        }

        // Initialize the application
        initApp();
    </script>
</body>
</html>